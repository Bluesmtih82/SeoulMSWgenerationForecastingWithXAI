# 설명가능한 AI를 통한 서울시 자치구별 생활폐기물 발생량 예측 모델 연구

## 1. 문제정의

&nbsp;&nbsp;2026년 수도권 폐기물 직매립 금지 법안이 시행된다. 수도권 매립지가 포화상태에 도달하면서 직매립 금지를 통해 매립되는 폐기물의 양을 줄여 매립지의 사용기한을 연장하려는 목적이다. 즉, 소각 및 재활용률의 제고가 가능할 것이다. 자치시/구 입장에서는, 최대한 직매립되는 폐기물의 양을 줄이고자 폐기물의 선별 과정을 강화할 수 있다. 더불어 직매립된 쓰레기가 유발하는 환경 오염을 방지하기 위한 목적도 있으리라 생각된다. 

&nbsp;&nbsp;그러나, 서울시는 마포구의 주민 반대에 부딪혀 소각장을 확보하지 못하여 하루 900톤 이상의 폐기물을 처리할 수 있는 방안이 없는 상황이다. 이러한 서울의 상황을 해결하기 위한 근본적인 접근은 생활 폐기물 발생량 자체를 줄이는 것에 있다고 보고 해당 연구를 진행하게 되었다. 

## 2. 연구목적

&nbsp;&nbsp;생활 폐기물 발생량은 어떤 변수들의 함수인지 알아내고자하는 것이 주요 목적이다. 이와 같은 성격의 모델링에 있어서는 선형 회귀 방식이 가장 직관적이나, 생활 폐기물은 그 발생 메커니즘이 비선형적인 양상을 보일 것이 자명하기 때문에 이에 유리한 머신러닝을 활용하여 Feature Importance를 도출하는 것이 핵심이다. 비록, 회귀 분석과 같이 특정 Feature 변수의 Marginal Effect를 밝혀내기는 어렵지만, SHAP 분석을 통한 "상대적 기여도"를 도출하여 정책 설계 시 어떤 변수를 고려해야할 지 방향성에 대한 힌트를 얻을 수 있을 것이다. 즉, 서울은 총 25개의 자치구로 이루어져있는 인구밀도가 굉장히 높은 도시이며 각기 다른 사회경제적 특징을 보여준다는 점에 착안하여, 서울시 전체를 대상으로 획일적인 감소 정책을 시행하기 보다는 자치구별로 맞춤형 정책을 시행하는 것이 효과적일 것이라 가정한다.

## 3. Feature 변수 선정

&nbsp;&nbsp;설명가능한 머신러닝 모델을 구축하기 위해서는 서울의 자치구별 생활 폐기물 발생량을 설명할 수 있으면서도 다른 도시와는 차별화되는 서울만의 고유한 특징을 담아내는 변수를 찾아야 한다. 왜냐하면, 먼저 일정 수준 이상의 예측 성능이 보장되어야 예측 값의 경위를 설명하는 것이 의미가 있기 때문이다. 유럽, 중동, 미국의 대도시 또는 국가 전체를 대상으로 한 선행 연구들은 사용하는 Feature 변수에 있어서는 큰 차이를 보이지 않았다. 주로 사용하는 머신러닝 알고리즘을 차별화해나가며 성능을 개선하는 데 집중하는 모습을 보여왔다. 하지만, 본 연구의 목적에 따라 서울의 자치구별 폐기물 발생량에 기여도가 높은(인과추론으로 발전시킬 여지가 있는) 새로운 Feature 변수를 찾는 것이 필요하다. 서울만이 가지고 있는 특징은 분명 전세계의 도시들과는 다를 것이기 때문이다.

&nbsp;&nbsp;기존 연구들이 주로 활용한 변수들은 인구 수, 나이, 소득 수준, 교육 수준 등이다. 해당 변수들은 모두 예측 값에 지대한 영향을 끼쳤다는 연구 결과가 많기 때문에 그대로 활용하되, 데이터를 구하기 힘든 경우에는 대리 변수를 활용했다. 가령, 소득 수준은 자치구별 GRDP 데이터가 없어, 지방세로 대체했으며 교육 수준은 연도별 데이터가 부재하여 Feature 변수에 포함시키지 않는 것으로 결정했다. 5년 간격으로는 교육 수준 데이터가 있었으나, 내삽이나 외삽은 결과의 신뢰도를 크게 떨어뜨리고 연구의 복잡도를 증가시킬 수 있기에 고려하지 않았다. 

&nbsp;&nbsp;생활 폐기물이 가장 많이 발생하는 요인 중 하나가 식당일 수 있다는 점과 인구밀도가 높다는 서울의 특징을 반영하기 위해 1인당 음식업체 수와 아파트 비율(호 기준)을 새로운 Feature 변수로 도입했다. 또한, Target 변수의 단위가 "1인당 하루 배출량(kg/person/day)"이기 때문에, 모든 Feature 변수도 인구 수로 나누어 정규화를 진행했다. 단순히 "큰 도시=폐기물 많음"을 학습하는 게 아니라, 생활 구조적 특성(1인당 배출 패턴) 을 포착할 수 있게 하기 위함이다. 다시 말하면, 인구 규모 효과를 제거하고 지역 특성에 따라 1인당 배출량이 어떻게 달라지는지를 보기 위해 per capita를 적용한 것이다. 이렇게 하면 정책적으로도 자치구 주민 특성별 맞춤형 해석이 가능하다는 장점이 있다고 생각한다.

&nbsp;&nbsp;2010~2023년의 25개 서울 자치구별 데이터를 수집했다. 환경부의 자원순환마루와 서울 열린데이터 광장으로부터 데이터를 얻을 수 있었다.

| Category | Variable                          | Abbr.             | Mean    | Median  | Min–Max          | Unit                                  |
|----------|-----------------------------------|-------------------|---------|---------|------------------|---------------------------------------|
| Feature  | Population ratios by age group    |                   |         |         |                  | Age group person / Total person       |
|          | 0–19 years                      | POP_0–19_Ratio    | 0.1624  | 0.1603  | 0.0859–0.2625    |                                       |
|          | 20–34 years                     | POP_20–34_Ratio   | 0.2339  | 0.2355  | 0.0836–0.3418    |                                       |
|          | 35–64 years                     | POP_35–64_Ratio   | 0.4656  | 0.4674  | 0.3128–0.5515    |                                       |
|          | 65 years and over               | POP_65_Ratio      | 0.1381  | 0.1356  | 0.0706–0.2342    |                                       |
|          | Single–person household ratio     | HHD_Ratio         | 0.3973  | 0.3961  | 0.2657–0.6232    | Single–person household / Total household |
|          | Population density                | POP_Density       | 17632.54| 17695.50| 6292–29049       | Person/km²                            |
|          | Local tax revenue per capita      | Tax_Per_Capita    | 1.9336  | 1.0522  | 0.3156–15.1489   | 1 million KRW / person                |
|          | Food service establishments/capita| Restaurant_Per_Capita | 0.0188 | 0.0142  | 0.0077–0.0709    | Establishments / person               |
|          | Apartment ratio                   | APT_Ratio         | 0.5653  | 0.5865  | 0.2676–0.8725    | Apartment / Total housing             |
| Target   | MSW generation per capita and day | MSWPD             | 0.8329  | 0.7614  | 0.1522–2.3815    | kg/person/day                         |

## 4. 모델 평가 지표

&nbsp;&nbsp;전통적인 시계열 회귀 예측 방법인 ARIMA를 벤치마크로써 활용하고, DNN, XGBoost, LightGBM 중에서 Best Model을 선정했다. 평가 기준(Metric)은 결정계수와 MAPE(Mean Absolute Percentage Error)이다. 제 1 평가지표는 MAPE가 될 것이다. 선제적으로 예측력을 보장해야하기 때문이다. 보조 지표로 결정 계수를 활용하여 예측을 하는 데 있어서 변수들의 설명력 수준을 파악하기 위해서이다. 두 지표 모두 일정 수준 이상이 되어야 모델을 설명하는 것이 의미를 가진다. 가령, MAPE는 높아도 결정 계수가 낮다면, Feature 변수들이 예측값을 도출하는 과정에 제대로 참여하고 있지 않다는 사실을 반증한다. 

## 5. 모델 비교 분석 및 Best Model 선정

&nbsp;&nbsp;총 4개의 알고리즘을 각각 하이퍼파라미터 튜닝 과정을 거쳐서 validation loss 기준으로 알고리즘별 Best Model을 선정하고, Test 데이터 기준 MAPE와 결정 계수 기준으로 다시 최종 Best Model 한 개를 선정한다. 데이터 분할을 할 때 시간 순서가 섞이지 않도록 유의해야한다. 미래 시점의 데이터 포인트를 훈련 데이터 포함하고 과거 시점의 데이터를 테스트 데이터에 포함하는 모순을 발생시킬 수 있기 때문이다.

| Models   | Parameter                                                                 | Data Partition (Train:Validation:Test) | MAPE   | R²      |
|----------|----------------------------------------------------------------------------|----------------------------------------|--------|---------|
| **DNN**  | Activation Function: ReLU <br> Node: 64-32 <br> Dropout: 0.15              | 9:0.5:0.5                              | 5.77%  | 0.9423  |
| **XGBoost** | Max_depth: 5 <br> Reg_lambda: 0.9 <br> Colsample_bytree: 0.8            | 7.5:1.5:1                              | 4.83%  | 0.9474  |
| **LightGBM** | Max_depth: 9 <br> Num_leaves: 63 <br> Reg_lambda: 0.9 <br> Colsample_bytree: 0.8 | 7:2:1                                  | 8.11%  | 0.8317  |
| **ARIMA** | p: 1 <br> q: 1 <br> d: 1                                                 | -                                      | 7.97%  | 0.1128  |

&nbsp;&nbsp;XGBoost가 MAPE=4.83%, 결정계수(R²)=0.9474로 모든 지표에서 가장 우수한 성적을 보여주었다. 향후 SHAP 분석을 적용할 Best Model로 활용한다.

## 6. SHAP 분석

















